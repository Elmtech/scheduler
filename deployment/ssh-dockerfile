FROM python:3.4.3-wheezy

ENV HOME_DIR "/home/webmaster"

RUN apt-get update && \
    apt-get install -y apt-utils && \
    apt-get install -y openssh-server git keychain vim bash-completion && \
    apt-get autoclean && apt-get -y autoremove

RUN pip install --no-cache-dir -U pip && \
    pip install --no-cache-dir -U virtualenv && \
    pip install --no-cache-dir -U distribute

RUN useradd -m -s /bin/bash -d $HOME_DIR webmaster && \
    mkdir -p $HOME_DIR && \
    mkdir -p $HOME_DIR/.ssh/ && \
    chown -R webmaster:webmaster $HOME_DIR && \
    touch $HOME_DIR/.ssh/authorized_keys

RUN sed -i 's/UsePAM yes/UsePAM no/' /etc/ssh/sshd_config && mkdir -p /var/run/sshd
CMD ["/usr/sbin/sshd", "-D"]
